var CalendarId = "xxx";
const LINE_TOKEN = 'xxx';
const GROUP_ID = 'xxx';

function dailyEventMessage() {
  var d = new Date(),
      cal = CalendarApp.getCalendarById(CalendarId),
      events = cal.getEventsForDay(d),
      fd = d.toLocaleDateString("th-TH", {day:"numeric", month:"long", year:"numeric"}),
      msg = events.length 
            ? `üì£ ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${fd} \nüî∂ ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${events.length} ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°\n`
            : `üì£ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${fd} ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°`;
  
  events.forEach(function(e, i) {
    msg += `\n${i+1}. üìÅ ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á : ${e.getTitle()}\n    ‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤ : ${e.getStartTime().toTimeString().slice(0,5)}-${e.getEndTime().toTimeString().slice(0,5)}\n    üìç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : ${e.getDescription()}\n`;
  });
  sendLineNotify(msg);
}

function sendLineNotify(m) {
  var payload = {to: GROUP_ID, messages: [{type: "text", text: m}]};
  UrlFetchApp.fetch("https://api.line.me/v2/bot/message/push", {
    method: "post",
    headers: {"Content-Type": "application/json", "Authorization": "Bearer " + LINE_TOKEN},
    payload: JSON.stringify(payload)
  });
}
